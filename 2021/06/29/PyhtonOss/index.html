<!DOCTYPE html>
<html lang="zh-Hans>">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">

    
    
    <meta name="google-site-verification"
          content="c66gcm0iMw487a2YC6w7cFbrhhe_Mh_vVNC6Pt3Dak8">
    

    
    
    <meta name="theme-color" content="#f9f9f9">
    

    
    

    
    <title>
        
        Pyhton&amp;aliyunOss
        &nbsp;|&nbsp;
        
        君子不器
    </title>

    
    
    <link type="image/x-icon" rel="shortcut icon"
          href="/favicon.png">
    

    
    
    <link rel="author" content="/humans.txt">
    

    
     
<link rel="stylesheet" href="/css/style.css">


<meta name="generator" content="Hexo 5.3.0"></head>


<body>

<div class="body-wrapper">
    <header>
    <div class="container">

        
        <div>
            <h1 class="logo">
                <a href="/">
                    君子不器
                </a>
            </h1>
        </div>

        
        <nav class="navbar">
            <ul class="navbar-menus">
                
                <li class="navbar-menus-item">
                    <a href="/">
                        
                        Home
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/categories">
                        
                        Categories
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/tags">
                        
                        Tags
                    </a>
                </li>
                
                <li class="navbar-menus-item">
                    <a href="/about">
                        
                        About
                    </a>
                </li>
                
            </ul>
        </nav>

    </div>
</header>


    <div class="main">
    <div class="container">

        <article class="post-body">

    <div class="title">
        <h1 class="title-inner">
            Pyhton&amp;aliyunOss
        </h1>

        <div class="title-meta">
            <span class="title-meta-time">
                2021-06-29
            </span>
        </div>
    </div>

    <div class="content">

        
        

        <h4 id="The-preface"><a href="#The-preface" class="headerlink" title="The preface"></a>The preface</h4><p>研发人员已使用Java将上传OSS bucket的代码封装。而为了安全考虑我们的Bucket统一设置为私有权限，此时，若使用代码直接上传文件，默认会继承Bucket的权限，而需求又是不想让文件权限为私有，好在Oss是支持代码在上传时即指定文件权限的,为防止打脸，亲身测一下先.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> oss2</span><br><span class="line"></span><br><span class="line"><span class="comment">##阿里云账号AccessKey</span></span><br><span class="line">auth = oss2.Auth(<span class="string">&#x27;yourAccessKey&#x27;</span>, <span class="string">&#x27;yourAccessKeySecret&#x27;</span>)</span><br><span class="line"></span><br><span class="line">endpoint = <span class="string">&#x27;yourendpoint&#x27;</span></span><br><span class="line">bucket = oss2.Bucket(auth, endpoint, <span class="string">&#x27;yourBucketname&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment">##指定上传文件权限</span></span><br><span class="line">headers = <span class="built_in">dict</span>()</span><br><span class="line">headers[<span class="string">&quot;x-oss-storage-class&quot;</span>] = <span class="string">&quot;Standard&quot;</span></span><br><span class="line">headers[<span class="string">&quot;x-oss-object-acl&quot;</span>] = oss2.OBJECT_ACL_PUBLIC_READ</span><br><span class="line"></span><br><span class="line"><span class="comment">#以二进制的方式打开文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;E:\\****.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fileobj:</span><br><span class="line">    <span class="comment"># Seek方法用于指定从第n个字节位置开始读写。上传时会从您指定的第*个字节位置开始上传，直到文件结束</span></span><br><span class="line">    fileobj.seek(<span class="number">0</span>, os.SEEK_SET)</span><br><span class="line">    <span class="comment"># Tell方法用于返回当前位置</span></span><br><span class="line">    current = fileobj.tell()</span><br><span class="line">    <span class="comment"># 填写Object完整路径。Object完整路径中不能包含Bucket名称</span></span><br><span class="line">    bucket.put_object(<span class="string">&#x27;****&#x27;</span>, fileobj, headers=headers)</span><br></pre></td></tr></table></figure>

<p>vue-admin-template</p>

    </div>

    
    

    
    

</article>

<div class="prev-next">
    <div class="wrapper">

        
        
        <div class="prev"></div>
        

        
        
        <div class="next">
            <a href="/2021/05/24/TCP%E7%8A%B6%E6%80%81%E6%B5%81%E8%BD%AC/">
                Older >
            </a>
        </div>
        

    </div>
</div>



    </div>
</div>

</div>

<footer>
    <div class="container text-center">

        
        <p class="copyright">
            <span>&copy; 2015 - 2017</span>
            <span> / </span>
            <span><a href="http://varzy.me" target="_blank">Aiden Zhao</a></span>
        </p>

    </div>
</footer>


</body>

</html>
